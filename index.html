<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PJ Barur</title>
    <style>
        :root {
            --primary-blue: #3498db;
            --light-blue: #e7f5ff;
            --dark-blue: #1e6fa3;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f9f9f9;
            color: #333;
        }
        
        /* Navbar Styling */
        .navbar {
            display: grid;
            background-color: white;
            width: 100%;
            overflow: hidden;
            margin: 10px 0 0 0;
            padding: 10px;
            gap: 10px;
            border: 2px solid var(--primary-blue);
            grid-template-columns: repeat(2, 1fr); /* 2 columns */
            grid-template-rows: repeat(2, auto); /* 2 rows */
        }
        
        .navbar a {
            color: var(--primary-blue);
            text-align: center;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.3s;
            text-transform: uppercase;
            font-size: 14px;
            background-color: var(--primary-blue);
            color: white;
            margin: 0;
            padding: 10px;
            border-radius: 6px;
            border: 2px solid var(--primary-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            height: 40px;
        }
        
        .navbar a:hover {
            background-color: var(--light-blue);
            color: var(--primary-blue);
            transform: scale(1.02);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-color: var(--light-blue);
        }
        
        /* Header Styling */
        .header {
            background-color: var(--light-blue);
            padding: 2px 20px;
            text-align: center;
            border-bottom: 2px solid var(--primary-blue);
            display: flex;
            flex-direction: column;
            gap: 3px;
            background: linear-gradient(to right, #1fa2ff, #12d8fa, #a6ffcb);
        }

        .header h1 {
            color: white;
            font-weight: 900;
            font-size: 2.5rem;
            text-transform: uppercase;
            text-shadow: 
                3px 3px 0 #000,
                -1px -1px 0 #000,  
                1px -1px 0 #000,
                -1px 1px 0 #000,
                1px 1px 0 #000;
            letter-spacing: 2px;
            margin: 10px 0;
        }
        
        /* Main Content */
        .container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0;
            border-radius: 6px;
        }
        
        /* Table Styling */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 0;
            background-color: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--dark-blue);
            border-radius: 6px;
            table-layout: fixed;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
            border-right: 1px solid #ddd;
        }
        
        th:last-child, td:last-child {
            border-right: none;
        }
        
        th {
            background-color: var(--primary-blue);
            color: white;
            position: sticky;
            top: 0;
        }
        
        tr:hover {
            background-color: #f5f5f5;
        }
        
        /* Button Styling */
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background-color: var(--primary-blue);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--dark-blue);
        }
        
        .btn-danger {
            background-color: #e74c3c;
            color: white;
        }
        
        .btn-danger:hover {
            background-color: #c0392b;
        }
        
        .btn-warning {
            background-color: #f39c12;
            color: white;
        }

        .btn-warning:hover {
            background-color: #e67e22;
        }

        .btn-success {
            background-color: #2ecc71;
            color: white;
        }
        
        .btn-success:hover {
            background-color: #27ae60;
        }
        
        /* Admin Controls */
        .admin-controls {
            display: flex;
            justify-content: center;
            margin: 3px 0;
            gap: 10px;
        }
        
        /* Modal Styling */
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.4);
        }
        
        .modal-content {
            background-color: white;
            margin: 10% auto;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            width: 400px;
            max-width: 90%;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .modal-header h2 {
            color: var(--dark-blue);
        }
        
        .close {
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .close:hover {
            color: #333;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
        }
        
        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .navbar a {
                flex: 1 0 50%; /* Keep 2 items per row even on mobile */
                padding: 8px;
            }
            
            table {
                font-size: 14px;
            }
            
            th, td {
                padding: 8px 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <h1>PJ BATUR</h1>
        <div class="admin-controls" id="adminControls">
        <button class="btn btn-warning" id="loginBtn">Kegiatan dan Monitoring Pekerjaan</button>
        <div id="adminActions" style="display: none;">
            <button class="btn btn-success" id="addDataBtn">Tambah Data</button>
            <button class="btn btn-warning" id="updateBtn">Update CSV</button>
            <button class="btn btn-danger" id="logoutBtn">Logout</button>
        </div>
    </div>
    </div>
    
    <!-- Navbar -->
    <div class="navbar">
        <a href="#">Urban</a>
        <a href="#">Patroli</a>
        <a href="#">Mandorline</a>
        <a href="#">Pemadaman</a>
    </div>
    
    <!-- Main Content -->
    <div class="container">
        
        <!-- Table -->
        <table id="dataTable">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Nama</th>
                    <th>Tanggal</th>
                    <th>Deskripsi</th>
                    <th>Lokasi</th>
                    <th>Status</th>
                    <th id="actionHeader">Aksi</th>
                </tr>
            </thead>
            <tbody id="tableBody">
                <!-- Data akan dimuat di sini -->
            </tbody>
        </table>
    </div>
    
    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Login Admin</h2>
                <span class="close">&times;</span>
            </div>
            <form id="loginForm">
                <div class="form-group">
                    <label for="username">Username</label>
                    <input type="text" id="username" required>
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-danger" id="cancelLogin">Batal</button>
                    <button type="submit" class="btn btn-primary">Login</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Add/Edit Modal -->
    <div id="dataModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Tambah Data Baru</h2>
                <span class="close">&times;</span>
            </div>
            <form id="dataForm">
                <input type="hidden" id="editIndex">
                <div class="form-group">
                    <label for="dataName">Nama</label>
                    <input type="text" id="dataName" required>
                </div>
                <div class="form-group">
                    <label for="dataDate">Tanggal</label>
                    <input type="date" id="dataDate" required>
                </div>
                <div class="form-group">
                    <label for="dataDesc">Deskripsi</label>
                    <textarea id="dataDesc" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label for="dataStatus">Status</label>
                    <select id="dataStatus" required>
                        <option value="Pending">Pending</option>
                        <option value="Dalam Proses">Dalam Proses</option>
                        <option value="Selesai">Selesai</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-danger" id="cancelModal">Batal</button>
                    <button type="submit" class="btn btn-primary">Simpan</button>
                </div>
            </form>
        </div>
    </div>
    
    <script>
        // Sample data (in production, this would be loaded from CSV)
        let csvData = [
            { id: 1, nama: "Proyek A", tanggal: "2023-05-15", deskripsi: "Instalasi pipa air di Jalan Merdeka", status: "Selesai" },
            { id: 2, nama: "Proyek B", tanggal: "2023-06-20", deskripsi: "Perbaikan jalan di Kampung Baru", status: "Dalam Proses" },
            { id: 3, nama: "Proyek C", tanggal: "2023-07-10", deskripsi: "Pembangunan poskamling", status: "Pending" }
        ];
        
        // DOM Elements
        const tableBody = document.getElementById('tableBody');
        const loginBtn = document.getElementById('loginBtn');
        const logoutBtn = document.getElementById('logoutBtn');
        const addDataBtn = document.getElementById('addDataBtn');
        const adminControls = document.getElementById('adminControls');
        const adminActions = document.getElementById('adminActions');
        const loginModal = document.getElementById('loginModal');
        const dataModal = document.getElementById('dataModal');
        const loginForm = document.getElementById('loginForm');
        const dataForm = document.getElementById('dataForm');
        const modalTitle = document.getElementById('modalTitle');
        const editIndex = document.getElementById('editIndex');
        const cancelLogin = document.getElementById('cancelLogin');
        const cancelModal = document.getElementById('cancelModal');
        const closeBtns = document.querySelectorAll('.close');
        
        // State
        let isAdminLoggedIn = false;
        let currentEditIndex = -1;
        
        // Initialize the table
        function loadTableData() {
            tableBody.innerHTML = '';
            // Show loading state
            tableBody.innerHTML = '<tr><td colspan="7" style="text-align:center">Memuat data...</td></tr>';
            
            csvData.forEach((data, index) => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${data.nama}</td>
                    <td>${formatDate(data.tanggal)}</td>
                    <td>${data.deskripsi}</td>
                    <td><span class="status-badge" style="background-color: ${getStatusColor(data.status)}">${data.status}</span></td>
                    <td>
                        ${isAdminLoggedIn ? `
                        <button class="btn btn-primary edit-btn" data-index="${index}">Edit</button>
                        <button class="btn btn-danger delete-btn" data-index="${index}">Hapus</button>
                        ` : ''}
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
            
            // Add event listeners to edit and delete buttons
            if (isAdminLoggedIn) {
                document.querySelectorAll('.edit-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        currentEditIndex = parseInt(e.target.getAttribute('data-index'));
                        openDataModal(currentEditIndex);
                    });
                });
                
                document.querySelectorAll('.delete-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const index = parseInt(e.target.getAttribute('data-index'));
                        if (confirm('Apakah Anda yakin ingin menghapus data ini?')) {
                            deleteData(index);
                        }
                    });
                });
            }
        }
        
        // Format date (YYYY-MM-DD to DD/MM/YYYY)
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('id-ID');
        }
        
        // Get color based on status
        function getStatusColor(status) {
            switch (status) {
                case 'Selesai': return '#2ecc71';
                case 'Dalam Proses': return '#f39c12';
                case 'Pending': return '#e74c3c';
                default: return '#95a5a6';
            }
        }
        
        // Open login modal
        function openLoginModal() {
            loginModal.style.display = 'block';
        }
        
        // Close login modal
        function closeLoginModal() {
            loginModal.style.display = 'none';
            loginForm.reset();
        }
        
        // Open data modal (for add/edit)
        function openDataModal(index = -1) {
            if (index >= 0) {
                modalTitle.textContent = 'Edit Data';
                editIndex.value = index;
                const data = csvData[index];
                document.getElementById('dataName').value = data.nama;
                document.getElementById('dataDate').value = data.tanggal;
                document.getElementById('dataDesc').value = data.deskripsi;
                document.getElementById('dataStatus').value = data.status;
            } else {
                modalTitle.textContent = 'Tambah Data Baru';
                editIndex.value = -1;
                dataForm.reset();
            }
            dataModal.style.display = 'block';
        }
        
        // Close data modal
        function closeDataModal() {
            dataModal.style.display = 'none';
            dataForm.reset();
        }
        
        // Add new data
        function addData(data) {
            csvData.push(data);
            if (csv.length > 0) {
                    loadTableData();
                } else {
                    alert(`Tidak dapat memuat data dari ${filename}`);
                    tableBody.innerHTML = '<tr><td colspan="7" style="text-align:center">Data tidak tersedia</td></tr>';
                }
        }
        
        // Edit existing data
        function editData(index, data) {
            csvData[index] = data;
            loadTableData();
        }
        
        // Delete data
        function deleteData(index) {
            csvData.splice(index, 1);
            loadTableData();
        }
        
        // Function to load CSV file
        async function loadCSV(filename = 'urban.csv') {
            try {
                const response = await fetch(filename);
                const csv = await response.text();
                const lines = csv.split('\n');
                const headers = lines[0].split(',');
                
                csvData = [];
                for(let i = 1; i < lines.length; i++) {
                    if(lines[i].trim() === '') continue;
                    const values = lines[i].split(',');
                    const obj = {};
                    for(let j = 0; j < headers.length; j++) {
                        obj[headers[j].trim()] = values[j] ? values[j].trim() : '';
                    }
                    csvData.push(obj);
                }
                loadTableData();
            } catch (error) {
                console.error('Error loading CSV:', error);
            }
        }
        
        // Function to handle menu clicks
        function setupMenuEvents() {
            document.querySelectorAll('.navbar a').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const filename = `${link.textContent.toLowerCase()}.csv`;
                    loadCSV(filename);
                    
                    // Update table header based on selection
                    document.querySelector('#dataTable thead th:nth-child(2)').textContent = 
                        link.textContent === 'Urban' ? 'Urban' : 
                        link.textContent === 'Patroli' ? 'Patroli' :
                        link.textContent === 'Mandorline' ? 'Mandorline' : 'Pemadaman';
                });
            });
        }
        
        // Save CSV (simulated)
        function saveCSV() {
            // Convert data to CSV format and save
            console.log('Saving CSV data...');
        }
        
        // Function to update CSV file
        function updateCSV() {
            if (confirm('Update data CSV? Perubahan akan disimpan ke file.')) {
                saveCSV();
                alert('Data CSV berhasil diupdate!');
            }
        }

        // Event Listeners
        const updateBtn = document.getElementById('updateBtn');
        updateBtn.addEventListener('click', updateCSV);
        
        loginBtn.addEventListener('click', openLoginModal);
        
        logoutBtn.addEventListener('click', () => {
            isAdminLoggedIn = false;
            adminActions.style.display = 'none';
            loginBtn.style.display = 'block';
            loadTableData();
        });
        
        addDataBtn.addEventListener('click', () => {
            openDataModal();
        });
        
        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            // Simple authentication (in production, use proper authentication)
            if (username === 'admin' && password === 'admin123') {
                isAdminLoggedIn = true;
                adminActions.style.display = 'flex';
                loginBtn.style.display = 'none';
                closeLoginModal();
                loadTableData();
            } else {
                alert('Username atau password salah!');
            }
        });
        
        dataForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const data = {
                id: csvData.length + 1,
                nama: document.getElementById('dataName').value,
                tanggal: document.getElementById('dataDate').value,
                deskripsi: document.getElementById('dataDesc').value,
                status: document.getElementById('dataStatus').value
            };
            
            if (editIndex.value >= 0) {
                editData(parseInt(editIndex.value), data);
            } else {
                addData(data);
            }
            
            saveCSV();
            closeDataModal();
        });
        
        cancelLogin.addEventListener('click', closeLoginModal);
        cancelModal.addEventListener('click', closeDataModal);
        
        closeBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                if (loginModal.style.display === 'block') {
                    closeLoginModal();
                } else if (dataModal.style.display === 'block') {
                    closeDataModal();
                }
            });
        });
        
        window.addEventListener('click', (e) => {
            if (e.target === loginModal) {
                closeLoginModal();
            } else if (e.target === dataModal) {
                closeDataModal();
            }
        });
        
        // Initialize
        loadCSV();
        setupMenuEvents();
    </script>
</body>
</html>
